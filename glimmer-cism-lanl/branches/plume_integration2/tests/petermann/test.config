###################################
#[GTHF]
# various stuff

[parameters]
# geothermal heat flux
# model%paramets%geot
geothermal = 0.0

# Glen's law A to use in isothermal case:
# model%paramets%default_flwa
default_flwa = 4.6e-18

# enhancement factor for glen's A 
# model%paramets%flow_factor
flow_factor = 1

# minimum thickness for running ice dynamics
# model%numerics%thklim
# ice_limit = 

# used to decide where to chop of marine ice
# NB: not used if marine_margin = 0 is used
# Choose an extremely large value for now to prevent any chopping
# model%numerics%mlimit
marine_limit = -10000

# fraction of ice to remove from floating ice
# when using marine_margin = 3
# model%numerics%calving_fraction
# calving_fraction = 

# time constant for basal hydrology
# model%paramets%hydtim
# hydro_time = 

# A 5-value parameter giving basal traction characteristics
# NB: seems to be obsolete since we use basal_tract_const 
# instead
# variable is temp
# basal_tract = 0.0 1.0 2.0 3.0 4.0

# basal_tract_const is used over the entire base of the ice
# so setting equal to 0.0 is good for a shelf
# model%paramets%btrac_const
# basal_tract_const = 0.0

# model%paramets%btrac_max
# basal_tract_max = 

# dependence of basal traction on basal water depth
# model%paramets%btrac_slope
# basal_tract_slope = 

# initial backstress assigned to areas of positive thickness
# NB: only used in case marine_margin = 5
# model%climate%stressin
# stressin = 

# initial backstress assigned to other areas
# model%climate%stressout
# stressout = 0.0

# NB: only used in case slip_coeff = 5
# model%climate%slidconst
# sliding_constant = 

# set degree of detail in logging:
# log_level = 6 means all messages
#	      0 means none
# loglevel
log_level = 6

#######################################
[Petermann shelf]
# constant air temperature above shelf
air_temperature = -25.0

# constant and uniform accumulation
accumulation_rate = 0.0

# Take eustatic_sea_level = 0.0 since we don't 
# investigate changing sea level
eustatic_sea_level = 0.0

#######################################
[options]
# i/o parameter file (containing more config info) 
# model%funits%ncfile
# ioparams =

# flow_law = 2 means constant A = 10^(-16)a^(-1)Pa^(-n)
# model%options%whichflwa
flow_law = 2

# evolution = 0 means pseudo-diffusion
#           = 1 means ADI scheme
#           = 2 means iterated diffusion
#           = 3 means LANL incrementral remapping method
#               for thickness advection
#           = 4 upwind advection
# model%options%whichevol
evolution = 3

# temperature = 1 means full 3D thermal evolution
#	      = 0 means set to air temperature
# model%options%whichtemp
temperature = 0

#vertical_integration = 1 means constrained to obey kinematic BC
# model%options%whichwvel
vertical_integration = 1

# marine_margin = 0 means ignore marine margin
#                = 2 means set thickness to zero if relaxed bedrock is more 
#                    than certain water depth (set ???)
# model%options%whichmarn
marine_margin = 2

# topo_is_relaxed = 1 means the initial topography is 
#                     already isostatically relaxed
# model%options%whichrelaxed
topo_is_relaxed = 1

# slip_coeff = 0 means set equal to zero everywhere
#            = 1 means basal traction is constant (basal_tract_const)
#            = 2 means Set to (non--zero) constant where where temperature
#                is at pressure melting point of ice, otherwise to zero
#             = 3 means function of basal water depth 
# model%options%whichbtrc
slip_coeff = 1

# self-explanatory
# model%options%periodic_ew
# model%options%periodic_ns
periodic_ew = 0
periodic_ns = 0

# x_invariant
# model%options%x_invariant
x_invariant = 0

# are we doing a restart (1 = yes, 0 = no)
# model%options%hotstart
hotstart = 0

# set diagnostic_run = 1 causes glide to stop in thck_lin_evolve subroutine right after
#                        running run_ho_diagnostic(model)
# model%options%diagnostic_run
diagnostic_run = 0

# basal_water = 0 means calc from local basal water balance
#             = 1 means compute basal water flux then find depth via cal
#             = 2 means no basal water
# model%options%whichbwat
basal_water = 2

# use_plume = 0 means use usual Glimmer-CISM method to calc bmlt
#            = 1 means use plume model to calculate bmlt above floating ice
# model%options%use_plume
use_plume = 1

##############################################
[grid]
# number of vertical levels : model%general%upn
upn = 11

# number of grid nodes in east-west direction : model%general%ewn
ewn = 46

# number of grid nodes in north-south direction : model%general%nsn
nsn = 46

# east-west grid spacing : model%numerics%dew
dew = 200

# north-south grid spacing : model%numerics%dns
dns = 200

# sigma_builtin = 0 means use the default sigma levels 
#	        = 1 means ???
# model%options%which_sigma_builtin
sigma_builtin = 1

###########################################
#[sigma]
# can specify all sigma levels, consistent with upn specified
# model%numerics%sigma
# sigma_levels = 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0

# sigma_file is the location of a file specifying
# sigma levels.  If not provided default levels
# are used.   
# model%funits%sigfile
# sigma_file = 

###############################################

#[ho_options]
# which higher-order prognostic scheme to use in 
# thickness evolution (only used in thick_nonline_evolve
# and thick_lin_evolve, but not in incremental remapping)
# prognostic_sheme = 0 means SIA only
#                    1 means Pattyn scheme 
# model%options%which_ho_prognostic
#prognostic_scheme = 0

# fallback solver method:
# which_ho_sparse_fallback = -1 means no fallback
# model%options%which_ho_sparse_fallback
which_ho_sparse_fallback = 3

# how to compute beta:
# basal_stress_input = 2 means basal traction is given directly
# model%options%which_ho_beta_in
basal_stress_input = 3

# basal_stress_type = 0 means linear
#                     1 means plastic
# NB: only matters inside subroutines velo_hom_pattyn and veloc2
# method of calculating residual: 
# model%options%which_ho_bstess
basal_stress_type = 0

# which_ho_resid = 0 means use max value
# NB: only used in glam_velo_fordsiapstr
# model%options%which_ho_resid
which_ho_resid = 1

# dissipation
# model%options%which_disp
which_disp = 

# basal melting
# model%options%which_bmelt
which_bmelt = 

# basal boundary condition: 
# which_ho_babc = 5 means simple ice-shelf (glam_strs2.F90:2855)
#                 7 means circular ice-shelf
# NB: only used when using Payne-Price diagnostic scheme
# model%options%which_ho_babc
which_ho_babc = 9

# how to compute source term for an ice shelf: 
# which_ho_source = 0 means vertically averaged
#                   1 means pressure dependent on depth
#                   2 means shelf front disabled  
# NB: only used inside Pattyn's veloc2 subroutine
# model%options%which_ho_source
which_ho_source = 0

# I don't understand this option yet, but false is more conservative
# model%velocity_hom%is_velocity_valid
guess_specified = 1

#which sparse solver to use:
#  which_ho_sparse = 0 means biconjugate gradiate with incomplete LU precond. 
#                    1 means GMRES
#                    2 means UMF (?)
#                    3 means PARADISO (?)
# model%options%which_ho_sparse
which_ho_sparse = 1

# which higher-order diagnostic scheme to use:
# diagnostic_scheme = 3 means Payne-Price scheme
#                     2 means Pattyn staggered ?            
# model%options%which_ho_diagnostic
diagnostic_scheme = 3

# whether or not to include thin ice in HO calculation
# 1 means true
# model%options%ho_include_thinice
include_thin_ice = 0

# ho effective viscosity : which_ho_efvs = 0 means calculate from strain rate
# model%options%which_ho_efvs
which_ho_efvs = 0

#################################################
[CF default]
comment = test runs for coupled plume-ice system
title = coupled confined shelf test
institution = NYU
references = 
################################################
[CF input]
#name of netcdf file containing input data fields
name = test.in.nc

#which time slice to read input data from
time = 1

################################################
[CF output]

### NB: there is a (250) character limit on line length!!!

# the following is a list of all possible output variables:
# level lithoz x0 x1 y0 y1 acab acab_tavg age artm backstress
# beta bheatflx bmlt bmlt_tavg btemp btrc bwat bwatflx calving 
# diffu dusrfdtm eus flwa gl_ew gl_ns gline_flux iarea ivol
# kinbcmask lat litho_temp lon lsurf relx slc soft surfvel tau_xz tau_yz
# taux tauy temp thk thkmask topg ubas ubas_tavg uflx usurf 
# uvel uvelhom vbas vbas_tavg velnormhom vflx vvel vvelhom wgrd wvel

variables = lsurf usurf thk bmlt uvelhom vvelhom uvelhom_srf uvelhom_bas vvelhom_srf vvelhom_bas thkmask topg beta btrc 

# time in between writing state to output file (in years)
frequency = 0.025

start = 
stop = 
mode = 

# name of output file
name = /scratch/GC_netcdf_output/test.out.nc

###########################################
[time]
# start time of model run (years) : model%numerics%tstart
tstart = 0.0

# end time of model run (years) : model%numerics%tend
tend = 0.025

# time step (years) : model%numerics%tinc
dt = 0.025

# isostasy dt factor
niso = 1.

# thermal dt factor : model%numerics%ntem
ntem = 1.

# velocity dt factor : model%numerics%nvel
nvel = 1.

# diagnostic frequency : model%numerics%ndiag
# ndiag =

# profile period : model%numerics%profile_period
# profile = 


################################################
[plume]
# path to plume namelist file
plume_nl_file = test.nl
plume_output_file = /scratch/GC_netcdf_output/plume.test.out.nc

# set to 1 in order to suppress all old-style ASCII data output
suppress_ascii_output = T

# set to T to suppress all screen and file output (logging)
suppress_logging = F

# prefix to put on the old style ASCII output
plume_output_prefix = plume_test

# where to write the output files
plume_output_dir = ./

# option to write out all states (all timesteps)
# NB it is very storage hungry
plume_write_all_states = .false.

# minimum time to spinup the plume, in days
plume_min_spinup_time = 5.d0

# minimum subcycle time, in days
plume_min_subcycle_time = 0.5d0

# plume steadiness tolerance (max relative change in bmelt)
plume_steadiness_tol = 1.d-6

plume_imin = 1
plume_imax = 46
plume_kmin = 1
plume_kmax = 42
 

plume_const_bmlt = 
plume_const_bmlt_rate = 
